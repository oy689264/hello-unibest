var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,i=(e,t)=>{for(var l in t||(t={}))s.call(t,l)&&o(e,l,t[l]);if(a)for(var l of a(t))n.call(t,l)&&o(e,l,t[l]);return e},u=(e,a)=>t(e,l(a));import{d as c,g as d,r,B as p,b as f,c as m,w as g,e as x,n as h,u as v,f as b,t as y,h as _,i as w,F as k,y as I,G as M,H as j,s as C,z as O,j as T,m as E,v as F,k as z,x as P,q as D,_ as q}from"./index-f33fdfc7.js";const A=q(c({__name:"card-match",setup(e){const{safeAreaInsets:t}=d(),l=r(!1),a=r(!1),s=r(""),n=r(13),o=r(0),c=r(!1),q=r(!1),A=[{id:1,name:"小丑",image:"https://picsum.photos/100/100?random=1"},{id:2,name:"皇后",image:"https://picsum.photos/100/100?random=2"},{id:3,name:"国王",image:"https://picsum.photos/100/100?random=3"},{id:4,name:"魔术师",image:"https://picsum.photos/100/100?random=4"},{id:5,name:"骑士",image:"https://picsum.photos/100/100?random=5"},{id:6,name:"龙",image:"https://picsum.photos/100/100?random=6"},{id:7,name:"女巫",image:"https://picsum.photos/100/100?random=7"},{id:8,name:"地精",image:"https://picsum.photos/100/100?random=8"},{id:9,name:"精灵",image:"https://picsum.photos/100/100?random=9"}],B=r(null),G=r([]),H=r([]),S=p((()=>"win"===s.value?"恭喜你，清空所有卡牌！":"lose"===s.value?"机会用完啦，再接再厉！":"准备好挑战了吗？"));function $(e){return H.value.some((t=>t.id===e.id))}function J(e){l.value=!1,s.value=e}function K(){setTimeout((()=>{const e=9===G.value.filter((e=>!e.isMatched)).length,t=!function(){const e=G.value.filter((e=>!e.isMatched)),t={};e.forEach((e=>{t[e.typeId]||(t[e.typeId]=[]),t[e.typeId].push(e)}));for(const l in t)if(t[l].length>=2)return!0;return!1}(),l=n.value<=0;t&&(e||l)&&J("lose")}),200)}function L(e){const t=[];for(let l=0;l<e;l++){const e=A[Math.floor(Math.random()*A.length)];t.push(u(i({},e),{typeId:e.id}))}return t}function N(){const e=G.value.filter((e=>!e.isMatched)),t={};e.forEach((e=>{t[e.typeId]||(t[e.typeId]=[]),t[e.typeId].push(e)}));let l=!1;for(const a in t)if(t[a].length>=2){const[e,s]=t[a];Q(e,G.value.findIndex((t=>t.id===e.id))),Q(s,G.value.findIndex((e=>e.id===s.id))),l=!0;break}l||(n.value>0?R():K())}function Q(e,t){!l.value||e.isMatched||$(e)||H.value.length>=2||(H.value.push(u(i({},e),{originalIndex:t})),2===H.value.length&&function(){const[e,t]=H.value;e.typeId===t.typeId?setTimeout((()=>{G.value.forEach((l=>{l.typeId!==e.typeId||l.id!==e.id&&l.id!==t.id||(l.isMatched=!0)})),o.value++,n.value++,C({title:"对碰成功，手牌+1",icon:"none"}),G.value.every((e=>e.isMatched))?J("win"):(H.value=[],a.value?setTimeout((()=>N()),300):K())}),500):setTimeout((()=>{H.value=[]}),1e3)}())}function R(){const e=9-G.value.filter((e=>!e.isMatched)).length;if(e<=0)return void C({title:"没有空位发牌",icon:"none"});if(n.value<=0)return C({title:"没有手牌可以发了",icon:"none"}),void K();const t=Math.min(e,n.value),l=L(t);n.value-=t,l.some((e=>e.typeId===B.value.id))&&(n.value++,C({title:"抽中许愿卡，手牌+1",icon:"none"}));const s=l.map((e=>u(i({},e),{id:Date.now()+Math.random(),isFlipped:!1,isMatched:!1}))),o=[...G.value];let c=0;for(let a=0;a<o.length;a++)o[a].isMatched&&c<s.length&&(o[a]=s[c],c++);G.value=o,setTimeout((()=>{G.value.forEach((e=>e.isFlipped=!0)),a.value?N():K()}),500)}function U(){l.value=!1,s.value="",n.value=13,o.value=0,B.value=null,G.value=[],H.value=[],q.value=!0}function V(){if(!B.value)return void C({title:"请先许愿！",icon:"none"});q.value=!1,l.value=!0;n.value-=9;const e=L(9);e.some((e=>e.typeId===B.value.id))&&(n.value++,C({title:"抽中许愿卡，手牌+1",icon:"none"}));const t=e.map((e=>u(i({},e),{id:Date.now()+Math.random(),isFlipped:!1,isMatched:!1})));G.value=function(e){for(let t=e.length-1;t>0;t--){const l=Math.floor(Math.random()*(t+1));[e[t],e[l]]=[e[l],e[t]]}return e}(t),setTimeout((()=>{G.value.forEach((e=>e.isFlipped=!0)),a.value?N():K()}),500)}function W(){a.value=!a.value,C({title:`切换到${a.value?"自动":"手动"}模式`,icon:"none"}),a.value&&l.value&&N()}return(e,i)=>{const u=T,d=E,r=D,p=F,C=z("layout-default-uni");return f(),m(C,null,{default:g((()=>[x(u,{class:"game-container bg-gradient-to-b from-indigo-500 to-purple-800 min-h-screen text-white overflow-hidden"},{default:g((()=>{var e,C;return[x(u,{class:"fixed top-0 left-0 right-0 z-20",style:h({paddingTop:(null==(e=v(t))?void 0:e.top)+"px"})},{default:g((()=>[x(u,{class:"flex items-center justify-between px-4 py-2"},{default:g((()=>[x(u,{class:"i-carbon-arrow-left text-xl",onClick:i[0]||(i[0]=e=>{O()})}),x(u,{class:"text-lg font-bold"},{default:g((()=>[b("盲盒对碰大挑战")])),_:1}),x(u,{class:"i-carbon-help text-xl",onClick:i[1]||(i[1]=e=>c.value=!0)})])),_:1})])),_:1},8,["style"]),x(u,{style:h({paddingTop:(null==(C=v(t))?void 0:C.top)+44+"px"})},{default:g((()=>[x(u,{class:"p-4"},{default:g((()=>[x(u,{class:"status-panel bg-white bg-opacity-20 rounded-xl p-4 mb-4 flex justify-around items-center"},{default:g((()=>[x(u,{class:"text-center"},{default:g((()=>[x(u,{class:"text-sm opacity-80"},{default:g((()=>[b("剩余手牌")])),_:1}),x(u,{class:"text-2xl font-bold"},{default:g((()=>[b(y(v(n)),1)])),_:1})])),_:1}),x(u,{class:"text-center"},{default:g((()=>[x(u,{class:"text-sm opacity-80"},{default:g((()=>[b("许愿卡牌")])),_:1}),v(B)?(f(),m(d,{key:0,src:v(B).image,class:"w-10 h-10 rounded-full mx-auto"},null,8,["src"])):(f(),m(u,{key:1,class:"text-lg font-bold"},{default:g((()=>[b("?")])),_:1}))])),_:1}),x(u,{class:"text-center"},{default:g((()=>[x(u,{class:"text-sm opacity-80"},{default:g((()=>[b("游戏模式")])),_:1}),x(u,{class:"text-lg font-bold"},{default:g((()=>[b(y(v(a)?"自动":"手动"),1)])),_:1})])),_:1})])),_:1}),x(u,{class:"relative"},{default:g((()=>[x(u,{class:"card-grid grid grid-cols-3 gap-3"},{default:g((()=>[(f(!0),_(k,null,w(v(G),((e,t)=>(f(),m(u,{key:e.id,class:"card-wrapper",onClick:l=>Q(e,t)},{default:g((()=>[x(u,{class:P(["card-inner rounded-lg shadow-lg transform transition-all duration-300",{"is-flipped":e.isFlipped,"is-selected":$(e),"is-matched":e.isMatched}])},{default:g((()=>[x(u,{class:"card-face card-back bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center"},{default:g((()=>[x(u,{class:"i-carbon-game-console text-4xl text-white opacity-50"})])),_:1}),x(u,{class:"card-face card-front bg-white flex flex-col items-center justify-center p-2"},{default:g((()=>[x(d,{src:e.image,class:"w-16 h-16"},null,8,["src"]),x(r,{class:"text-xs text-gray-800 mt-1"},{default:g((()=>[b(y(e.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1}),v(l)?I("",!0):(f(),m(u,{key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex flex-col items-center justify-center z-10 rounded-xl"},{default:g((()=>[x(u,{class:"text-3xl font-bold mb-4"},{default:g((()=>[b(y(v(S)),1)])),_:1}),v(s)?(f(),m(u,{key:0,class:"text-lg mb-4"},{default:g((()=>[b("本次成功对碰 "+y(v(o))+" 次",1)])),_:1})):I("",!0),x(p,{class:"bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 px-8 rounded-full text-lg font-bold shadow-lg",onClick:U},{default:g((()=>[b(y(v(s)?"再玩一次":"开始游戏"),1)])),_:1})])),_:1}))])),_:1}),x(u,{class:"pt-4 text-center"},{default:g((()=>[v(l)&&!v(a)&&v(n)>0?(f(),m(u,{key:0,class:"mb-4"},{default:g((()=>[x(p,{class:"bg-green-500 text-white py-2 px-6 rounded-full font-bold",onClick:R},{default:g((()=>[b(" 继续发牌 ")])),_:1})])),_:1})):I("",!0),v(l)?(f(),m(p,{key:1,class:"bg-gray-500 bg-opacity-30 text-white py-2 px-6 rounded-full font-bold",onClick:W},{default:g((()=>[b(" 切换为"+y(v(a)?"手动":"自动")+"模式 ",1)])),_:1})):I("",!0)])),_:1})])),_:1})])),_:1},8,["style"]),v(q)?(f(),m(u,{key:0,class:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-30"},{default:g((()=>[x(u,{class:"bg-white rounded-2xl p-6 w-11/12 max-w-sm text-gray-800"},{default:g((()=>[x(u,{class:"text-xl font-bold text-center mb-4"},{default:g((()=>[b("许个愿吧！")])),_:1}),x(u,{class:"text-sm text-center mb-6"},{default:g((()=>[b(" 选择一张你最想抽中的卡牌，抽中它会给你带来好运哦！ ")])),_:1}),x(u,{class:"grid grid-cols-3 gap-4 mb-6"},{default:g((()=>[(f(),_(k,null,w(A,(e=>x(u,{key:e.id,class:"flex flex-col items-center",onClick:t=>function(e){B.value=e}(e)},{default:g((()=>[x(d,{src:e.image,class:P(["w-16 h-16 rounded-full border-4",v(B)&&v(B).id===e.id?"border-purple-500":"border-transparent"])},null,8,["src","class"]),x(r,{class:"text-xs mt-2"},{default:g((()=>[b(y(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"]))),64))])),_:1}),x(p,{class:"w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-xl text-lg font-bold shadow-lg",onClick:V,disabled:!v(B)},{default:g((()=>[b(" 选好了，开始！ ")])),_:1},8,["disabled"])])),_:1})])),_:1})):I("",!0),v(c)?(f(),m(u,{key:1,class:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-30",onClick:i[4]||(i[4]=e=>c.value=!1)},{default:g((()=>[x(u,{class:"bg-white rounded-2xl p-6 w-11/12 max-w-sm text-gray-800",onClick:i[3]||(i[3]=M((()=>{}),["stop"]))},{default:g((()=>[x(u,{class:"text-xl font-bold text-center mb-4"},{default:g((()=>[b("游戏规则")])),_:1}),x(u,{class:"space-y-3 text-sm"},{default:g((()=>[j("p",null,[b(" 1. 点击开始游戏，可以 "),j("strong",{class:"text-purple-600"},"许愿"),b(" 想要的卡牌。 ")]),j("p",null,[b(" 2. 系统随机发放 "),j("strong",{class:"text-purple-600"},"9张牌"),b(" 。 ")]),j("p",null,[b(" 3. 点击两张 "),j("strong",{class:"text-purple-600"},"相同的牌"),b(" 进行对碰消除。 ")]),j("p",null,[b(" 4. "),j("strong",{class:"text-purple-600"},"手动模式"),b(" : 每次对碰后需点击继续发牌。 ")]),j("p",null,[b(" 5. "),j("strong",{class:"text-purple-600"},"自动模式"),b(" : 自动连续发牌直到无法对碰。 ")]),j("p",null,[b(" 6. 抽中 "),j("strong",{class:"text-purple-600"},"许愿牌"),b(" 可获得额外发牌机会+1。 ")])])),_:1}),x(p,{class:"mt-6 w-full bg-gray-200 text-gray-700 py-2 rounded-lg",onClick:i[2]||(i[2]=e=>c.value=!1)},{default:g((()=>[b(" 关闭 ")])),_:1})])),_:1})])),_:1})):I("",!0)]})),_:1})])),_:1})}}}),[["__scopeId","data-v-dbe2c5c6"]]);export{A as default};
